<div class="applications-container">

  <ul class="nav list-inline tabs-underlined nav-fill" id="myTab" role="tablist">
    <li class="nav-item" role="presentation">
      <a class="nav-link <%= "active" unless params[:reminder] %> tab-underlined" data-toggle="tab" id="applications-tab" href="#applications" role="tab" area-controls="applications" area-selected="true" >My Applications</a>
    </li>
    <li class="nav-item" role="presentation">
      <a class="nav-link <%= "active" if params[:reminder] %> tab-underlined" data-toggle="tab" id="reminders-tab" href="#reminders" role="tab" area-controls="reminders" area-selected="false" >My Reminders</a>
    </li>
  </ul>

  <div class="tab-content" id="myTabContent">
    <div class="tab-pane fade <%= "active show" unless params[:reminder] %>" id="applications" area-labelledby="applications-tab" role="tabpanel">
      <div class="row dashboard" data-controller="draggable">
        <% { "Saved" => content_tag(:i, "", class: "far fa-star"), "Applied" => content_tag(:i, "", class: "far fa-file"), "Interviewing" => content_tag(:i, "", class: "fas fa-phone"), "Offer" => content_tag(:i, "", class: "fas fa-medal"), "Rejected" => content_tag(:i, "", class: "far fa-thumbs-down") }.each do |status, icon| %>
          <div class="col">
            <div class="status-card">
              <div class="row card-title">
                <%= link_to new_application_path(status: status) do %>
                  <h5 class="icon add"><%= fa_icon "plus" %></h5>
                <% end %>
                <h6><%= status %></h6>
                <h5 class="icon"><%= icon %></h5>
              </div>
              <ul class="card-text dropzone" data-target="draggable.column" data-status="<%= status %>">
                <% @applications.where(application_status: status).each do |application| %>
                    <li data-target="draggable.item" data-url="<%= application_path(application) %>" class="application-card">
                      <div class="application-grid">
                        <%= image_tag "https://cdn.worldvectorlogo.com/logos/google-icon.svg", class: "avatar dropdown-toggle", id: "company-logo", data: { toggle: "dropdown" }, 'aria-haspopup': true, 'aria-expanded': false %>
                        <div class="application-title">
                          <h6><%= application.company_name %></h6>
                          <p><%= application.job_title %></p>
                        <div class="date-icon">
                          <p id="status"><em><%= application.updated_at.strftime("%B %e, %Y") %></em></p>
                          <%= link_to application_path(application), class: "z-index" do %>
                            <%= fa_icon "arrow-circle-right", class: "icon arrow" %>
                          <% end %>
                        </div>
                        </div>
                       </div>
                      </li>
                  <% end %>
                </ul>
              </div>
            </div>
          <% end %>
        </div>
      </div>

  <div class="tab-pane fade <%= "active show" if params[:reminder] %>" id="reminders" area-labelledby="reminders-tab" role="tabpanel">
      <div class="reminder-button-container d-flex justify-content-around mt-3">
        <div class="m-0">
          <button type="button" data-toggle="modal" data-target=".create-modal" id="reminder-button-index">+ Add Reminder</button>
        </div>
      </div>
    <div class="reminders-container">
      <% @reminders.order(scheduled_date: :desc).each do |reminder| %>
          <div class="reminders-card">
            <%= form_for reminder, remote: true, url: application_reminder_path(reminder.application, reminder), method: :patch, class: "reminder-form" do |f| %>
               <%= hidden_field_tag "authenticity_token", form_authenticity_token %>
                <div class="reminder-card-top">
                  <%= f.check_box :completed, input_html: { value: "completed" }, class: "reminder-checkbox" %>
                    <% end %>
                  <div class="reminder-content">
                    <p id="reminder-title"><strong><%= reminder.title %></strong></p>
                    <p id="pretty-name"><em><%= reminder.application.pretty_name%></em></p>
                  </div>
                </div>
                <div class="reminder-card-info">
                  <p class="reminder-date"><%= reminder.scheduled_date %></p>
                  <p><%= link_to reminder_path(reminder), method: :delete, data: { confirm: "Are you sure you want to delete this reminder?" }, class: "reminder-delete" do %>
                    <i class="fa fa-trash icon add" aria-hidden="true"></i>
                  <% end %></p>
                </div>
              </div>
          <% end %>
      </div>

      <div class="modal fade bd-example-modal-lg create-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="container notes-form">
              <%= simple_form_for @reminder do |f| %>
              <%= f.input :title %>
              <%= f.association :application, label_method: :pretty_name %>
              <%= f.input :scheduled_date %>
              <div class="submit-button-container d-flex justify-content-around mb-4">
                <%= f.button :submit, class:"button"%>
              </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

