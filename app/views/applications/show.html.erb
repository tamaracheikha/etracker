<div class="container-fluid">
  <div class="row">
    <div class="col-12 col-md-7">
      <ul class="nav list-inline tabs-underlined nav-fill mb-3" id="pills-tab" role="tablist">
        <li class="nav-item">
          <a class="nav-link tab-underlined <%= "active" unless params[:note] %>" id="pills-overview-tab" data-toggle="pill" href="#pills-overview" role="tab" aria-controls="pills-overview" aria-selected="true">Overview</a>
        </li>
        <li class="nav-item">
          <a class="nav-link tab-underlined <%= "active" if params[:note] %>" id="pills-notes-tab" data-toggle="pill" href="#pills-notes" role="tab" aria-controls="pills-notes" aria-selected="false">Notes</a>
        </li>
      </ul>
      <div class="tab-content" id="pills-tabContent">
        <div class="tab-pane fade show <%= "active show" unless params[:note] %>" id="pills-overview" role="tabpanel" aria-labelledby="pills-overview-tab">
          <div class="card overview pl-3">
            <div class="application-info">
            <div class= "d-flex justify-content-start align-items-center symbols">
                <h1><%= @application.company_name %></h1>
                <h4><%= link_to edit_application_path(@application) do %></h4>
                  <h4 class="icon add"><%= fa_icon "edit" %></h4>
                <% end %>
                <h4><%= link_to application_path(@application), method: :delete, data: { confirm: "Are you sure you want to delete this application?" } do %></h4>
                  <h4><i class="fa fa-trash icon add" aria-hidden="true"></i></h4>
                <% end %>
              </div>
              <div class="d-flex">
                <div class= "d-flex justify-content-start mr-4">
                  <i class="fas fa-user symbol"></i><p class="ml-1"><%= @application.job_title %></p>
                </div>
                <div class= "d-flex justify-content-start">
                  <i class="fas fa-link symbol"></i><%= link_to @application.company_link, @application.company_link, class:"ml-1", target:"blank" %>
                </div>
                <div type="button" class="button-showpage ml-4" data-toggle="modal" data-target=".cv-modal">
                  <i class="far fa-file-pdf mr-2"></i>CV
                </div>
                <div class="modal fade cv-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
                  <div class="modal-dialog modal-xlg">
                    <div class="modal-content">
                      <% if @application.cv.attached? %>
                       <%= cl_image_tag @application.cv.key, format: :png, class: 'modal-img' %>
                      <% end %>
                    </div>
                  </div>
                </div>

            </div>
            <div class= "d-flex">
              <div class= "d-flex justify-content-start mr-4">
                <i class="fas fa-map-marker-alt symbol"></i><p class="ml-1"><em><%= @application.location %></em></p>
              </div>
              <div class= "d-flex justify-content-start">
                <i class="fas fa-clock symbol"></i><p class="ml-1"><%= @application.application_status %></p>
              </div>
              <div class="button-showpage ml-4" data-toggle="modal" data-target=".coverletter-modal">
                <i class="far fa-file-alt mr-2"></i>Cover Letter
              </div>
              <div class="modal fade coverletter-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-xlg">
                  <div class="modal-content">
                    <% if @application.cover_letter.attached?  %>
                      <%= cl_image_tag @application.cover_letter.key, format: :png, class: 'modal-img' %>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>
          </div>
            <p style="white-space: pre-line;"><%= @application.job_description %></p>
          </div>
        </div>
        <div class="tab-pane fade <%= "active show" if params[:note] %>" id="pills-notes" role="tabpanel" aria-labelledby="pills-notes-tab">
          <div class="notes">
            <% @application.notes.each do |note| %>
              <div class="card" id="notes-content">
                  <h5 class="mr-2 mb-0 title-card"><%= note.title %></h5>
                <p><%= note.rich_content %></p>
                <div class="d-flex justify-content-between align-items-center symbols mb-3">
                <p class="mb-0 card-date"><%= note.date.strftime("%B %e, %Y") %></p>
                  <p class="mb-0 pl-4"><%= link_to edit_note_path(note) do %></p>
                    <p class="mb-0 icon add"><%= fa_icon "edit" %></p>
                  <% end %>
                  <p class="mb-0"><%= link_to note_path(note), method: :delete, data: { confirm: "Are you sure you want to delete this note?" } do %></p>
                    <i class="fa fa-trash icon add" aria-hidden="true"></i>
                  <% end %>
                 </div>
              </div>
            <% end %>
          </div>
          <div class="d-flex justify-content-around">
            <button type="button" class="text-underline add-notes-button btn-block mb-4 w-50" data-toggle="modal" data-target=".create-note-modal">+ Add New Note</button>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 col-md-5">
      <div class="p-5 mt-4">
        <div class="timeline-box" >
          <div class="">
            <button type="button" class="text-underline reminder-button btn-block mb-4 w-50" data-toggle="modal" data-target=".create-reminder-modal">+ Add Reminder</button>
          </div>
          <div class="timeline">
            <% @application.reminders.order(scheduled_date: :desc).each do |reminder| %>
              <div class="d-flex align-items-start note-wrapper">
                <div class= "timeline-note" type="button" data-toggle="modal" data-target="#edit_<%= dom_id(reminder) %>"></div>
                <div class="border timeline-reminder"><%= reminder.title %> <small class="text-muted"><em><%= reminder.scheduled_date %></em></small></div>
              </div>
              <div class="modal fade bd-example-modal-lg" id="edit_<%= dom_id(reminder) %>" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                  <div class="modal-content">
                    <%= simple_form_for reminder do |f| %>
                      <%= f.input :title %>
                      <%= f.input :description %>
                      <%= f.input :scheduled_date %>
                      <%= f.submit class: 'btn btn-primary' %>
                    <% end %>
                    <%= reminder.scheduled_date %>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade bd-example-modal-lg create-note-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class=" container notes-form">
          <%= simple_form_for [@application, @note] do |f| %>
          <%= f.input :title %>
          <p><%= f.rich_text_area :rich_content %></p>
          <div class="submit-button-container d-flex justify-content-around mb-4">
            <%= f.button :submit, class:"button"%>
          </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="modal fade bd-example-modal-lg create-reminder-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class=" container reminder-form">
        <%= simple_form_for @reminder do |f| %>
        <%= f.input :title %>
        <p><%= f.input :scheduled_date %></p>
        <%= f.input :application_id, as: :hidden, input_html: { value: @application.id } %>
        <div class="submit-button-container d-flex justify-content-around mb-4">
          <%= f.button :submit, class:"button"%>
        </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
